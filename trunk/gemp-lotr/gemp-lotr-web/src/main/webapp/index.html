<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Gemp-LotR</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style type="text/css">
        body {
            font-size: 12px;
        }

        .ui-button-text-only .ui-button-text {
            font-size: 70%;
            padding: .2em .5em;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="css/dark-hive/jquery-ui-1.8.16.custom.css">

    <script type="text/javascript" src="js/jquery/jquery-1.6.2.js"></script>
    <script type="text/javascript" src="js/jquery/jquery-ui-1.8.16.custom.min.js"></script>

    <script type="text/javascript" src="js/inheritance.js"></script>
    <script type="text/javascript" src="js/logging.js"></script>
    <script type="text/javascript" src="js/communication.js"></script>

    <script type="text/javascript">
        function getUrlParam(param) {
            var search = window.location.search.substring(1);
            if (search.indexOf('&') > -1) {
                var params = search.split('&');
                for (var i = 0; i < params.length; i++) {
                    var key_value = params[i].split('=');
                    if (key_value[0] == param) return key_value[1];
                }
            } else {
                var params = search.split('=');
                if (params[0] == param) return params[1];
            }
            return null;
        }

        jQuery.fn.center = function () {
            this.css("position", "absolute");
            this.css("top", (($(window).height() - this.outerHeight()) / 2) + $(window).scrollTop() + "px");
            this.css("left", (($(window).width() - this.outerWidth()) / 2) + $(window).scrollLeft() + "px");
            return this;
        };

        var comm = new GempLotrCommunication("/gemp-lotr/server", function() {
            alert("Unable to contact the server");
        });

        function processResponse(html) {
            $("#message").append(html).center();
            attachEvents();
        }

        $(document).ready(
                function() {
                    comm.getStatus(processResponse);
                });

        function attachEvents() {
            var loginButton = $("#loginButton");
            if (loginButton != null) {
                loginButton.button().click(
                        function() {
                            var login = $("#login").val();
                            var password = $("#password").val();
                            $("#message").html("");
                            comm.login(login, password, processResponse);
                        });
            }

            var registerButton = $("#registerButton");
            if (registerButton != null) {
                registerButton.button().click(
                        function() {
                            var login = $("#login").val();
                            var password = $("#password").val();
                            var password2 = $("#password2").val();
                            if (password != password2) {
                                alert("Password and Password repeated are different!");
                            } else {
                                $("#message").html("");
                                comm.register(login, password, processResponse);
                            }
                        });
            }

            var clickToRegisterButton = $("#clickToRegister");
            if (clickToRegisterButton != null) {
                clickToRegisterButton.button().click(
                        function() {
                            $("#message").html("");
                            comm.getRegistrationForm(processResponse);
                        });
            }
        }
    </script>

</head>
<body bgcolor="#000000">
<div id="message" style="color:#ffffff;"></div>
</body>
</html>
